# Changelog

## SDK v1.1.0 — 2026-02-16
- feat(sdk): add typed `ActivationResult` and `LicenseStatusResult` — no more raw strings or thrown exceptions
- feat(sdk): add `RequestTrialAsync` method for one-call trial activation
- feat(sdk): add `ValidateLocal` method with stored public key — no manual key passing needed
- feat(sdk): enrich `SoftLicenceClient` constructor with optional `publicKeyXml` parameter
- refactor(ui): `LicenseActivationViewModel` now delegates to `SoftLicenceClient` instead of raw `HttpClient`
- chore(sdk): remove placeholder `Class1.cs`
- test(sdk): add 13 unit tests for `SoftLicenceClient` (activate, trial, status, local validation)

## 2026-02-16
- feat(sdk): add AppId support in activation requests
- feat(sdk): update ISoftLicenceClient interface with AppId support
- feat(api): add AppId support for product lookup and maintain lowercase name matching
- feat(security): implement geometric punishment and zero tolerance for repeat offenders
- test(sdk): add unit tests for CheckOnlineStatusAsync (VALID, NOT_FOUND, SERVER_ERROR, NETWORK_ERROR, REVOKED)
- ci: add GitHub Actions workflow with test gate before NuGet publish
- feat(sdk): enforce online check at startup and physical license deletion on invalidation

## 2026-02-15
- feat(sdk): handle NOT_FOUND license status as a hard stop
- feat(audit): categorize root access as PORTAL_ENTRY and hide it with scans
- feat(security): increase 404 penalty to 10pts during quarantine
- feat(security): implement quarantine throttling, lower 404 severity, and allow anonymous root access
- fix(licenses): resolve concurrency issues and secure history formatting during revocation
- ui(licenses): add HH:mm to seat activation and last seen timestamps
- feat(users): enhanced user management with custom admin paths, account status, and reinforced security
- feat(telemetry): capture and display client IP address and ISP info
- feat(audit): show full IP addresses in audit logs
- feat(ui): display full hardware ID in telemetry tables and add column to product view
- feat(ui): switch to flag-icons CSS library to resolve 404 flag errors
- fix(ui): eliminate circuit crashes during license revocation and add selective DB reset
- debug(blazor): enable detailed errors and secure UI event handlers to diagnose crash
- feat(maintenance): add selective data reset with checkboxes in Reset Database modal
- feat(audit): capture and display response body for all logged requests
- fix(security): eliminate ObjectDisposedException in background audit tasks

## 2026-02-14
- fix(security): resolve duplicate variable declarations in AuditMiddleware
- test(server): improve I18N resilience for MultiSeat and VersionControl tests
- feat(security): prioritize ban checks and add proactive scan detection in AuditMiddleware
- refactor(server): harmonize license history tracking and fix transaction handling for tests
- chore: enforce strict compilation rules (Warnings as Errors) and fix test dependencies
- fix(i18n): localize license life cycle history details and UI labels
- fix: copy LICENSE file to docker build context for SDK packaging
- feat: implement immutable license lifecycle history (Carnet de santé)
- fix(i18n): finalize localization for resets history and manual reset tool
- feat: implement hardware ID history and global reset confirmation
- fix: update Dockerfile to use SoftLicence.SDK
- feat: transform resets page into a functional manual unlinking tool
- chore: finalize changelog and version for audit UI refactor
- ui: refactor audit page with tabs for logs and bans
- chore: commit remaining database schema and migration files
- ui: enhance audit logs with method-specific badge colors
- fix: resolve translation keys and normalize product name casing in logs
- fix(i18n): finalize localization of API responses and Admin UI
- fix(i18n): finalize localization by replacing hardcoded strings in Controllers and Views
- feat(sdk): refactor Core to SDK, standardize HardwareID (16-hex) and add Client API
- feat(ui): add confirmation modals for license revocation and fix culture redirection
- feat(i18n): transition to local assets for offline support and add I18N documentation
- feat(i18n): set English as default, add documentation translations and silence production logs
- fix(i18n): fix resource loading by moving SharedResource to root
- feat(i18n): complete localization for remaining Admin pages
- Localized Backups, Products, Telemetry, and Users pages.
- Fixed field initialization error in Users.razor.
- Added language selector to MainLayout top bar.
- wip: implement I18N and enhanced ban security system
- Setup localization (FR/EN) across the Admin UI using IStringLocalizer.
- Refactored ban system: added recidivism tracking with escalated duration (1d, 7d, 30d).
- Updated Audit UI to show ban history and active/expired status.
- Migrated BannedIp model to support persistence of previous bans.

## 2026-02-13
- security: auto-backup database before applying migrations
- feat(auth): add email notifications for users and force password change on first login
- feat(auth): fix and complete RBAC permissions for all pages and menu items
- feat(auth): implement RBAC with custom roles, users management and granular permissions
- fix(products): prevent deletion of products with existing licenses and ensure confirmation
- feat(security): backup full RSA key pair (Private + Public) to cloud on product creation
- ui(backup): update refresh and restore icons to Lucide style
- ui(backup): update restore icon and fix table header
- ui(nav): update menu icons to Lucide-style SVGs
- feat(backup): add side-by-side database comparison and high-end restoration modal
- deploy: fix rclone config persistence and permission error
- fix(backup): persist last backup date to prevent redundant backups on restart
- ui(backup): improve diagnostic feedback and log visibility
- feat(backup): implement database restoration system with cloud download and auto-restart
- ui(backup): reorganize layout with status, diagnostic console, and full-width history table
- feat(settings): implement persistent server settings table and fix backup toggle state
- ui(nav): remove redundant maintenance link from sidebar
- chore: disable backups by default and fix resets icon
- feat(backup): add cloud backup master toggle in dashboard
- ui(nav): replace text-only links with consistent SVG icons in admin menu
- chore(release): update changelog and bump version to 0.0.71
- test(server): fix CleanupServiceTests dependency injection for BackupService
- feat(backup): complete rclone integration and diagnostic dashboard implementation
- feat(backup): add daily cloud backup dashboard with remote file listing and health diagnostic
- feat(backup): integrate rclone for automatic Google Drive encrypted backups (keys and database)
- feat(security): implement RSA private key encryption at-rest and improved product creation UX with backup option

## 2026-02-12
- security: comprehensive server audit fix and architectural hardening
- Audit Complet: Tracing admin actions in audit logs.
- Admin IP Whitelist: Fixed verification logic (exact match required).
- Reset Codes: Use of RandomNumberGenerator (CSPRNG) for 6-digit codes.
- Data Leaks: Removal of license key enumeration in error logs.
- Zombie Detection: Threshold relaxed to 5 IPs/24h and removal of aggressive automatic IP ban.
- Thread-Safety: Refactored TelemetryService with IDbContextFactory.
- Data Protection: CleanupService disabled by default (configurable).
- Referential Integrity: Disabled cascade delete on products (Restrict).
- DB Migration: Added 'ProtectProductDelete' migration.
- Stealth Routing: Fixed blocking of static files (favicon) via Regex constraint.
- Trial Mode: Secured detection and removal of arbitrary fallback.
- Test Maintenance: Complete update of the unit test suite.
- UI: Replaced '??' with '--' for missing countries in audit and maintenance tables.
- security: fix multiple vulnerabilities and architectural issues from code audit
- Fix CleanupService silent data deletion (now configurable)
- Fix TelemetryService thread-safety with IDbContextFactory
- Fix AdminController IP whitelist logic
- Fix AuditMiddleware to include admin actions and prevent race conditions
- Fix ActivationController: remove license key leakage and use CSPRNG for reset codes
- Fix SecurityService: soften zombie detection to reduce false positives
- Fix Login routing to prevent blocking static files (favicon.ico)
- Fix LicenseDbContext: prevent cascade delete on products
- security: remove dangerous automatic database deletion logic in Program.cs
- fix(geoip): resolve dual database reader for local ISP and City resolution
- security: harden middleware against bot scans and finalize security dashboard
- feat(security): enrich banned IPs view with GeoIP, ISP and reasons; add proactive scan detection
- feat: implement admin UI for multi-seat management and license type seat configuration
- fix(ui): restore background opacity for BOT_SCAN logs
- feat: implement software version control for licenses with automated masking and audit tracking
- docs: update roadmap and finalize version
- fix(ui): improve audit logs visibility with BOT_SCAN contrast and full IP tooltips
- feat(geoip): implement 100% local ISP resolution with GeoLite2-ASN database
- feat: implement background cleanup service for logs and telemetry
- build: final preparation for production deployment
- build: prepare for deployment and production testing
- docs: update roadmap and project metadata
- fix(audit): reposition middleware before authorization and harden background logging scope
- fix(notifications): use query parameters for NTFY to support UTF-8 and raw text messages
- quality: implement project integrity tests, resolve GeoIP obsoleteness and modernize build script UI
- ci: integrate unit tests into build script via -Test parameter
- test: implement comprehensive unit test suite for core and security services
- feat(security): implement active defense with auto-ban, threat scoring and ntfy notifications
- feat(security): implement Geo-IP and ISP/Proxy detection in audit logs
- feat(ui): add banned IPs management and display revocation reasons in admin
- feat(webhooks): implement programmable notifications system (UI + Service)
- feat(security): implement local GeoIP and Zombie Detection (Multi-IP HardwareID Ban)
- fix: Login page blank screen, AuditMiddleware stream issue, and minor fixes
- feat(audit): capture and display raw request body in audit logs for enhanced debugging of validation errors

## 2026-02-11
- feat(api): implement secure license renewal with transaction tracking and recurring mode validation
- feat(core): add 'Reference' custom field to licenses and signed license files
- feat(api): support auto-trial via magic license key suffix (-FREE-TRIAL)
- feat(api): implement auto-trial endpoint and default duration per license type
- fix(api): add detailed server-side logging for activation failures and normalize license keys (Trim/ToUpper)
- feat(ui): implement automatic browser timezone detection for all date displays
- feat(telemetry): implement license recovery tracking and detailed telemetry UI
- feat(telemetry): implement license recovery tracking with activation counter
- feat(ui): add detailed telemetry modal to product management page
- feat(audit): add modal to display and copy detailed error messages
- feat(api): allow regenerating product API secret from dashboard with confirmation
- style(ui): move settings to top bar and add professional icons for user, settings and logout
- fix(api): fix build errors in documentation and telemetry controller
- feat(telemetry): add read-only API endpoint for product-specific telemetry retrieval with API key protection
- feat(audit): capture and display detailed error messages in access logs
- style(ui): apply dark mode theme to pagination components globally
- feat(ui): add tabbed interface and improved pagination to product details view
- feat(ui): overhaul product detailed view with independent paginated tables for Licenses, Telemetry and Access Logs
- feat(ui): add dedicated license reset tracking page and improved logging
- feat(reset): implement self-service license reset system via email validation
- feat(email): finalize branding by removing all technical mentions and using product name as sender
- feat(email): apply professional HTML template to both license delivery and diagnostic emails
- feat(email): implement professional HTML template for license delivery
- fix(email): restore professional license template and separate diagnostic logic
- security(smtp): remove password length and format from diagnostic logs after success
- diag(smtp): show masked password format to help debug docker interpolation
- fix(smtp): also trim single quotes from configuration values
- fix(deploy): use direct env pass-through for SMTP to avoid $ expansion issues
- diag(smtp): capture specific SMTP status codes for better debugging
- fix(smtp): sanitize configuration by trimming quotes and log password length for debugging
- fix(smtp): log supported auth mechanisms for better diagnostic
- fix(ui): restore missing @page directive on settings page
- fix(deploy): pass SMTP environment variables to the docker container
- fix(smtp): improve diagnostic accuracy and display current server configuration
- feat(ui): add pagination with configurable page size to all tables
- feat(smtp): implement detailed live diagnostic console for SMTP testing
- fix(telemetry): make product search case-insensitive
- style(ui): improve status code coloring in audit log
- feat(telemetry): implement complete structured telemetry system with API, Service and UI
- feat(ui): add interactive filters for Method and Status in audit log
- style(ui): condense audit log table to single line per row
- style(ui): apply sentence case to all page titles and section headers
